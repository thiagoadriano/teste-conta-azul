var APPCA;!function(a){function e(){}e.$inject=[],angular.module("AppContaAzul",["ngRoute","ngTable"]).run(e)}(APPCA||(APPCA={}));var APPCA;!function(a){function e(a){a.when("/veiculos",{templateUrl:"views/veiculos.html",controller:"VeiculosController",controllerAs:"vm"}).otherwise({redirectTo:"/veiculos"})}e.$inject=["$routeProvider"],angular.module("AppContaAzul").config(e)}(APPCA||(APPCA={}));var APPCA;!function(a){function e(a,e,t,n,o,r){function l(){var a={initialParams:{count:5,filter:s.search},initialSettings:{counts:[],paginationMaxBlocks:13,paginationMinBlocks:2,dataset:s.lista}};return new e(a.initialParams,a.initialSettings)}function i(){s.listaModelos=[],s.Model.marca&&(s.listaModelos=t.getModelos(s.Model.marca))}function c(){a.BuscarTodos().then(function(a){s.lista=a,s.tableParams=l()})}var s=this,u=[];s.lista=[],s.listaMarcas=[],s.listaModelos=[],s.titleModal="Incluir",s.allChecks=!1,s.search="",s.Model=n.model(),s.tableParams=l(),s.selecionaModelos=i,s.abrirModal=function(){s.titleModal="Incluir",s.listaModelos=[],s.Model=n.model(),$("#veiculosModal").modal("show")},s.editar=function(e){var t=a.BuscarUm(e);s.Model=t,s.titleModal="Editar",i(),$("#veiculosModal").modal("show")},s.salvar=function(e){e&&(s.Model.hasOwnProperty("id")?a.Atualizar(s.Model):a.Salvar(s.Model),c(),$("#veiculosModal").modal("hide"))},s.excluir=function(e){o.excluir(e.placa,function(){a.Deletar(e),c()})},s.validaPlaca=function(){a.testaPlaca(s.Model.placa),a.existePlaca(s.Model.placa)},s.marqueAllChecks=function(){s.lista.forEach(function(a){s.allChecks?a.linhaAtiva=!0:a.linhaAtiva=!1})},s.ativaLinha=function(a){a.linhaAtiva=!a.linhaAtiva,s.allChecks=!1},s.upper=function(){var a=s.Model.placa;if(a)return s.Model.placa=a.toUpperCase()},s.corrigeValor=function(){if(!/\D/g.test(s.Model.valor)){var a=s.Model.valor.replace(/\./g,"");return s.Model.valor=(+a).toLocaleString()}},s.filtrar=function(){!s.search&&u.length?(s.lista=angular.copy(u),s.tableParams=l(),u=[]):s.search&&(u.length||(u=angular.copy(s.lista)),r("filter")(s.lista,s.search),s.tableParams=l())},s.numeros=function(){if(s.Model.valor)return s.Model.valor=s.Model.valor.replace(/\D/g,"")},c(),t.getMarcas().then(function(a){s.listaMarcas=a}),$(document).on("click",'[data-toggle="lightbox"]',function(a){a.preventDefault(),$(this).ekkoLightbox()})}e.$inject=["VeiculosService","NgTableParams","MarcasService","VeiculosModel","UtilHelpers","$filter"],angular.module("AppContaAzul").controller("VeiculosController",e)}(APPCA||(APPCA={}));var APPCA;!function(a){function e(){function a(a,e,t){return'<li><p class="alert alert-'+a+' alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><span class="glyphicon glyphicon-'+e+'"></span> <strong>'+t+"</strong></p></li>"}function e(){return"<div class='alertSystem'><ul class='list-alert'></ul></div>"}function t(a){c(i(a))}function n(a){if("string"==typeof a){if(null!==a.match(/^\[.*\]$/))return o(a);if(null!==a.match(/^\{.*\}$/))return r(a)}else{if(angular.isArray(a))return a.join("<br>");if(angular.isObject(a))return r(JSON.stringify(a))}return a}function o(a){return JSON.parse(a).join("<br>")}function r(a){return a.replace(/^\{(.*)\}$/,"$1").split(",").join("<br>")}function l(){return u.find(".alertSystem").is(":visible")}function i(a){var t=$(a).attr("id",Date.now()).hide();return l()||u.prepend(e()),u.find(".alertSystem .list-alert").append(t).find("li").last().fadeIn()}function c(a){var e=a.attr("id"),t=setTimeout(function(){u.find(".alertSystem").find("#"+e).fadeOut("slow",function(){$(this).remove(),clearTimeout(t),s()})},6e3)}function s(){u.find(".alertSystem").find("li").length||u.find(".alertSystem").empty().remove()}var u=$("main");return{success:function(e){t(a("success","ok-sign",n(e)))},info:function(e){t(a("info","info-sign",n(e)))},warning:function(e){t(a("warning","alert",n(e)))},danger:function(e){t(a("danger","remove-sign",n(e)))}}}e.$inject=[],angular.module("AppContaAzul").factory("MsgInfos",e)}(APPCA||(APPCA={}));var APPCA;!function(a){angular.module("AppContaAzul").factory("UtilHelpers",function(){return{searchItemId:function(a,e){a.sort(function(a,e){return a.id>e.id});for(var t=a.length,n=Math.round(t/2),o=e<=n?0:n;o<e;o++)if(a[o].id===e)return a[o];return null},getNomeImagemLink:function(a){if(a){var e=a.split("/"),t=e[e.length-1];return t=t.replace(/\.[a-z]{3,4}$/,""),(t=t.replace(/(_|\.)/g," ")).substring(0,18)}},excluir:function(a,e,t,n,o){e&&BootstrapDialog.show({type:BootstrapDialog.TYPE_DANGER,size:BootstrapDialog.SIZE_SMALL,title:n||"Excluir Registro",message:o||"Deseja realmente excluir o registro: <br><strong>"+a+"</strong>?",buttons:[{label:"Não",cssClass:"btn-default",action:function(a){a.close(),t&&t()}},{label:"Sim",cssClass:"btn-danger",action:function(a){a.close(),e()}}]})}}})}(APPCA||(APPCA={}));var APPCA;!function(a){angular.module("AppContaAzul").factory("VeiculosModel",function(){var a={combustivel:"",imagem:"",marca:"",modelo:"",placa:"",valor:0};return{model:function(){return angular.copy(a)}}})}(APPCA||(APPCA={}));var APPCA;!function(a){function e(a,e){var t=[],n={},o=e.defer();return a.get("data/marcas-veiculos.json").then(function(a){var e=angular.fromJson(a.data);t=e.Marcas,n=e.Modelos,o.resolve(t)}),{getMarcas:function(){return o.promise},getModelos:function(a){return n[a]}}}e.$inject=["$http","$q"],angular.module("AppContaAzul").service("MarcasService",e)}(APPCA||(APPCA={}));var APPCA;!function(a){function e(a,e,t,n){function o(){i.forEach(function(a){a.valorCorrigido="R$ "+(+a.valor).toLocaleString()+",00",a.nomeImagem=n.getNomeImagemLink(a.imagem),a.linhaAtiva=!1})}function r(a){for(var e=i.length;e--;)if(i[e].placa===a)return t.danger("Já existe um veículo cadastrado com a placa informada"),!0;return!1}function l(a){return!!/[a-zA-Z]{3}-[0-9]{4}/.test(a)||(t.danger("A placa não está no formato correto"),!1)}var i=[];return{BuscarTodos:function(){var t=e.defer();return i.length?(o(),t.resolve(i)):a.get("data/conta-azul-dados.json").then(function(a){i=angular.fromJson(a.data.Veiculos),o(),t.resolve(i)}),t.promise},BuscarUm:function(a){return n.searchItemId(i,a)},Salvar:function(a){l(a.placa)&&(r(a.placa)||(0!==a.valor&&(a.valor=a.valor.replace(/\./g,"")),i.push(a),t.success("Veículo cadastrado com sucesso!")))},Atualizar:function(a){if(l(a.placa)&&!r(a.placa)){var e=i.indexOf(a);a.valor=a.valor.replace(/\./g,""),i[e]=a,t.success("Veículo atualizado com sucesso!")}},Deletar:function(a){var e=i.indexOf(a);e>=0&&(i.splice(e,1),t.success("Veículo excluido com sucesso!"))},existePlaca:r,testaPlaca:l}}e.$inject=["$http","$q","MsgInfos","UtilHelpers"],angular.module("AppContaAzul").service("VeiculosService",e)}(APPCA||(APPCA={}));
//# sourceMappingURL=maps/app.min.js.map
